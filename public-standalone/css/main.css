/* ============================================
   genmine CRM - Main Stylesheet
   遺伝子パネル検査 SFA 専用デザイン
   ============================================ */

/* --- Reset & Base --- */
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI','Helvetica Neue','Hiragino Sans',sans-serif;background:#f4f6f9;color:#333;font-size:14px}
a{color:#0176d3;text-decoration:none}
a:hover{text-decoration:underline}

/* --- Layout --- */
#app{display:flex;height:100vh;overflow:hidden}
.sidebar{width:260px;background:linear-gradient(180deg,#0d1b2a 0%,#1b2838 100%);color:#fff;overflow-y:auto;flex-shrink:0;display:flex;flex-direction:column}
.main{flex:1;display:flex;flex-direction:column;overflow:hidden}
.topbar{background:#fff;border-bottom:1px solid #e0e5ee;padding:0 24px;display:flex;justify-content:space-between;align-items:center;height:56px;flex-shrink:0}
.content{flex:1;overflow-y:auto;padding:24px;background:#f4f6f9}

/* --- Sidebar --- */
.sidebar-brand{padding:20px;border-bottom:1px solid rgba(255,255,255,.08)}
.sidebar-brand h2{font-size:16px;color:#4fc3f7;letter-spacing:1px;font-weight:700}
.sidebar-brand small{color:rgba(255,255,255,.5);font-size:11px}
.nav-group{padding:8px 0;border-top:1px solid rgba(255,255,255,.06)}
.nav-group-title{padding:10px 20px 6px;font-size:10px;font-weight:700;text-transform:uppercase;color:rgba(255,255,255,.35);letter-spacing:1px}
.nav-item{padding:9px 20px 9px 16px;cursor:pointer;font-size:13px;border-left:3px solid transparent;transition:all .15s;display:flex;align-items:center;gap:10px;color:rgba(255,255,255,.75)}
.nav-item:hover{background:rgba(255,255,255,.06);border-left-color:#4fc3f7;color:#fff}
.nav-item.active{background:rgba(79,195,247,.15);border-left-color:#4fc3f7;color:#4fc3f7;font-weight:600}
.nav-item .icon{width:20px;text-align:center;font-size:15px}
.nav-item .count{margin-left:auto;background:rgba(255,255,255,.12);padding:1px 7px;border-radius:10px;font-size:10px;color:rgba(255,255,255,.6)}

/* --- Topbar --- */
.topbar h1{font-size:17px;font-weight:600;display:flex;align-items:center;gap:10px}
.topbar h1 .icon{font-size:20px}
.user-area{display:flex;align-items:center;gap:14px;font-size:13px}
.badge{padding:3px 12px;border-radius:12px;font-size:11px;font-weight:600}
.badge-admin{background:#e8f5e9;color:#2e7d32}
.badge-rep{background:#e3f2fd;color:#1565c0}
.badge-msl{background:#f3e5f5;color:#7b1fa2}

/* --- Buttons --- */
.btn{padding:8px 18px;border:none;border-radius:4px;cursor:pointer;font-size:13px;font-weight:600;transition:all .15s;display:inline-flex;align-items:center;gap:6px}
.btn-primary{background:#0176d3;color:#fff}.btn-primary:hover{background:#015ba8}
.btn-success{background:#2e7d32;color:#fff}.btn-success:hover{background:#1b5e20}
.btn-danger{background:#c62828;color:#fff}.btn-danger:hover{background:#b71c1c}
.btn-secondary{background:#e8ecef;color:#333}.btn-secondary:hover{background:#d5dbe0}
.btn-sm{padding:5px 12px;font-size:11px}
.btn-icon{padding:6px 10px;background:none;color:#666;border:1px solid #ddd;border-radius:4px}
.btn-icon:hover{background:#f5f5f5;color:#333}
.btn-group{display:flex;gap:8px}

/* --- Cards --- */
.card{background:#fff;border:1px solid #e0e5ee;border-radius:8px;padding:20px;margin-bottom:16px;box-shadow:0 1px 3px rgba(0,0,0,.04)}
.card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
.card-header h3{font-size:15px;font-weight:600}
.card-header .subtitle{font-size:12px;color:#888}

/* --- KPI Cards --- */
.kpi-row{display:grid;gap:16px;margin-bottom:20px}
.kpi-row.cols-3{grid-template-columns:repeat(3,1fr)}
.kpi-row.cols-4{grid-template-columns:repeat(4,1fr)}
.kpi-row.cols-6{grid-template-columns:repeat(6,1fr)}
.kpi-card{background:#fff;border:1px solid #e0e5ee;border-radius:8px;padding:20px;text-align:center;position:relative;overflow:hidden}
.kpi-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px}
.kpi-card.blue::before{background:#0176d3}
.kpi-card.green::before{background:#2e7d32}
.kpi-card.orange::before{background:#e65100}
.kpi-card.purple::before{background:#7b1fa2}
.kpi-card.red::before{background:#c62828}
.kpi-card.teal::before{background:#00897b}
.kpi-val{font-size:32px;font-weight:700;color:#0176d3;line-height:1.2}
.kpi-label{font-size:11px;color:#888;margin-top:6px;font-weight:500}
.kpi-sub{font-size:11px;color:#2e7d32;margin-top:2px}

/* --- Tables --- */
.table-wrap{overflow-x:auto}
table{width:100%;border-collapse:collapse}
thead{background:#f7f9fc;border-bottom:2px solid #e0e5ee}
th{padding:10px 14px;text-align:left;font-weight:600;font-size:11px;color:#555;text-transform:uppercase;letter-spacing:.3px;white-space:nowrap;cursor:pointer;user-select:none}
th:hover{background:#eef1f6}
th .sort-icon{margin-left:4px;font-size:10px;color:#aaa}
td{padding:10px 14px;border-bottom:1px solid #eee;font-size:13px}
tbody tr{transition:background .1s}
tbody tr:hover{background:#f5f8ff;cursor:pointer}
.cell-link{color:#0176d3;font-weight:500}
.cell-link:hover{text-decoration:underline}

/* --- Sub-text (hospital name under doctor name) --- */
.sub-text{font-size:11px;color:#888;margin-top:2px;font-weight:400}

/* --- Status Badges --- */
.status{display:inline-block;padding:3px 10px;border-radius:12px;font-size:11px;font-weight:600;white-space:nowrap}
.s-green{background:#e8f5e9;color:#2e7d32}
.s-blue{background:#e3f2fd;color:#1565c0}
.s-orange{background:#fff3e0;color:#e65100}
.s-red{background:#ffebee;color:#c62828}
.s-gray{background:#f5f5f5;color:#666}
.s-purple{background:#f3e5f5;color:#7b1fa2}
.s-teal{background:#e0f2f1;color:#00695c}
.s-yellow{background:#fffde7;color:#f57f17}

/* --- Forms --- */
.form-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.form-group{margin-bottom:0}
.form-group.full{grid-column:1/-1}
.form-group label{display:block;font-size:12px;font-weight:600;color:#555;margin-bottom:5px}
.form-group label .req{color:#c62828;margin-left:2px}
.form-control{width:100%;padding:9px 12px;border:1px solid #d5dbe0;border-radius:4px;font-size:13px;transition:border-color .15s}
.form-control:focus{outline:none;border-color:#0176d3;box-shadow:0 0 0 2px rgba(1,118,211,.15)}
select.form-control{appearance:auto}
textarea.form-control{min-height:80px;resize:vertical}

/* --- Detail View --- */
.detail-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:20px}
.detail-title{font-size:22px;font-weight:700}
.detail-subtitle{font-size:13px;color:#888;margin-top:4px}
.detail-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
.detail-field{margin-bottom:12px}
.detail-field .dl{font-size:11px;color:#888;font-weight:600;margin-bottom:3px;text-transform:uppercase;letter-spacing:.3px}
.detail-field .dv{font-size:14px;padding:6px 0;min-height:28px}

/* --- Related Lists --- */
.related-list{margin-top:24px}
.related-list-header{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:2px solid #e0e5ee;margin-bottom:0}
.related-list-header h4{font-size:14px;font-weight:600}
.related-list-header .rl-count{background:#e8ecef;padding:2px 8px;border-radius:10px;font-size:11px;margin-left:8px}

/* --- Kanban --- */
.kanban{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px;padding:16px 0}
.kanban-col{background:#f7f9fc;border-radius:8px;padding:14px;min-height:200px}
.kanban-col-header{font-weight:600;font-size:13px;margin-bottom:12px;padding-bottom:10px;border-bottom:3px solid #0176d3;display:flex;justify-content:space-between;align-items:center}
.kanban-col-header .cnt{background:#0176d3;color:#fff;border-radius:10px;padding:2px 8px;font-size:10px}
.kanban-card{background:#fff;border:1px solid #e0e5ee;border-radius:6px;padding:12px;margin-bottom:10px;cursor:pointer;transition:all .15s}
.kanban-card:hover{box-shadow:0 4px 12px rgba(0,0,0,.08);transform:translateY(-2px)}
.kanban-card .kc-title{font-weight:600;font-size:13px;margin-bottom:4px}
.kanban-card .kc-sub{font-size:11px;color:#888}
.kanban-card .kc-amount{font-size:14px;font-weight:700;color:#0176d3;margin-top:6px}

/* --- Charts --- */
.chart-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:20px}
.chart-card{background:#fff;border:1px solid #e0e5ee;border-radius:8px;padding:20px}
.chart-card h4{font-size:13px;font-weight:600;margin-bottom:12px;color:#555}
.chart-card canvas{max-height:280px}

/* --- Tabs --- */
.tab-bar{display:flex;gap:0;border-bottom:2px solid #e0e5ee;margin-bottom:20px}
.tab-btn{padding:10px 24px;cursor:pointer;font-size:13px;font-weight:500;border-bottom:3px solid transparent;color:#666;margin-bottom:-2px;transition:all .15s}
.tab-btn:hover{color:#333;background:#f7f9fc}
.tab-btn.active{color:#0176d3;border-bottom-color:#0176d3;font-weight:600}

/* --- Search & Filters --- */
.toolbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;gap:12px;flex-wrap:wrap}
.search-box{display:flex;align-items:center;background:#fff;border:1px solid #d5dbe0;border-radius:4px;padding:0 12px;flex:1;max-width:400px}
.search-box input{border:none;outline:none;padding:8px 0;font-size:13px;width:100%}
.search-box .search-icon{color:#999;margin-right:8px}
.filter-group{display:flex;gap:8px;align-items:center}
.filter-select{padding:7px 12px;border:1px solid #d5dbe0;border-radius:4px;font-size:12px;background:#fff}

/* --- Funnel --- */
.funnel-row{display:flex;align-items:center;margin:6px 0}
.funnel-bar{height:32px;background:#0176d3;border-radius:3px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:11px;font-weight:600;min-width:60px;transition:width .3s}
.funnel-label{width:130px;font-size:12px;color:#555;flex-shrink:0}
.funnel-val{margin-left:8px;font-size:12px;color:#888;width:100px}

/* --- Modal --- */
.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.4);z-index:1000}
.modal{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;border-radius:8px;box-shadow:0 20px 60px rgba(0,0,0,.2);z-index:1001;width:90%;max-width:700px;max-height:85vh;overflow-y:auto}
.modal-header{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;border-bottom:1px solid #e0e5ee}
.modal-header h3{font-size:16px;font-weight:600}
.modal-close{background:none;border:none;font-size:22px;cursor:pointer;color:#888;padding:4px 8px}
.modal-close:hover{color:#333}
.modal-body{padding:24px}
.modal-footer{padding:16px 24px;border-top:1px solid #e0e5ee;display:flex;justify-content:flex-end;gap:10px}
.hidden{display:none!important}

/* --- Toast --- */
.toast{position:fixed;bottom:24px;right:24px;background:#333;color:#fff;padding:12px 24px;border-radius:6px;z-index:1002;font-size:13px;box-shadow:0 4px 12px rgba(0,0,0,.2);animation:slideUp .3s}
.toast.success{background:#2e7d32}
.toast.error{background:#c62828}
@keyframes slideUp{from{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}

/* --- Progress Bar --- */
.progress{height:8px;background:#e0e5ee;border-radius:4px;overflow:hidden}
.progress .bar{height:100%;border-radius:4px;transition:width .3s}

/* --- Timeline --- */
.timeline{list-style:none}
.timeline li{padding:10px 0 10px 24px;border-left:2px solid #e0e5ee;position:relative;font-size:13px}
.timeline li::before{content:'';position:absolute;left:-5px;top:14px;width:8px;height:8px;background:#0176d3;border-radius:50%;border:2px solid #fff}
.timeline li .tl-time{font-size:11px;color:#888}
.timeline li .tl-text{margin-top:2px}

/* --- Pagination --- */
.pagination{display:flex;justify-content:space-between;align-items:center;padding:12px 0;font-size:12px;color:#888}

/* --- Calendar View --- */
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:1px;background:#e0e5ee;border:1px solid #e0e5ee;border-radius:8px;overflow:hidden}
.cal-header{background:#f7f9fc;padding:10px;text-align:center;font-weight:600;font-size:12px;color:#555}
.cal-day{background:#fff;min-height:100px;padding:8px;font-size:12px}
.cal-day.other{background:#fafafa;color:#ccc}
.cal-day .day-num{font-weight:600;margin-bottom:4px}
.cal-event{background:#e3f2fd;color:#1565c0;padding:2px 6px;border-radius:3px;font-size:10px;margin-bottom:2px;cursor:pointer;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.cal-event.task{background:#fff3e0;color:#e65100}
.cal-event.visit{background:#e8f5e9;color:#2e7d32}
.cal-event.seminar{background:#f3e5f5;color:#7b1fa2}

/* --- Map Container --- */
#map-container{border:1px solid #e0e5ee;border-radius:8px;z-index:1}
#map-container.edit-mode{border-color:#e65100;box-shadow:0 0 0 2px rgba(230,81,0,.2)}
.leaflet-popup-content .btn{padding:4px 10px;font-size:11px}
.leaflet-popup-content .btn+.btn{margin-left:4px}

/* --- Map Guide Overlay --- */
#map-guide-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);z-index:2000;cursor:pointer}
#map-guide-highlight{position:fixed;border:3px solid #0176d3;border-radius:8px;z-index:2001;pointer-events:none;box-shadow:0 0 0 4000px rgba(0,0,0,.35);animation:guide-pulse 1.5s infinite}
#map-guide-tooltip{position:fixed;background:#fff;border-radius:10px;padding:18px 22px;z-index:2002;box-shadow:0 8px 30px rgba(0,0,0,.25);max-width:380px;min-width:280px;animation:guide-fade-in .25s}
@keyframes guide-pulse{0%,100%{box-shadow:0 0 0 4000px rgba(0,0,0,.35),0 0 0 0 rgba(1,118,211,.4)}50%{box-shadow:0 0 0 4000px rgba(0,0,0,.35),0 0 0 8px rgba(1,118,211,.15)}}
@keyframes guide-fade-in{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}

/* --- Daily Report & Approval Cards --- */
.report-card{background:#fff;border:1px solid #e0e5ee;border-radius:8px;padding:18px;margin-bottom:12px;cursor:pointer;transition:all .15s;border-left:4px solid #0176d3}
.report-card:hover{box-shadow:0 4px 12px rgba(0,0,0,.08);transform:translateY(-1px)}
.report-card.draft{border-left-color:#999}
.report-card.submitted{border-left-color:#e65100}
.report-card.approved{border-left-color:#2e7d32}
.report-card.rejected{border-left-color:#c62828}
.report-card h4{font-size:14px;font-weight:600;margin-bottom:4px}
.report-card .report-meta{font-size:11px;color:#888;display:flex;gap:12px;margin-bottom:8px}
.report-card .report-summary{font-size:13px;color:#555;line-height:1.5}
.report-card .report-actions{margin-top:10px;display:flex;gap:8px;justify-content:flex-end}

.approval-card{background:#fff;border:1px solid #e0e5ee;border-radius:8px;padding:18px;margin-bottom:12px;border-left:4px solid #e65100;transition:all .15s}
.approval-card:hover{box-shadow:0 4px 12px rgba(0,0,0,.08)}
.approval-card.approved{border-left-color:#2e7d32;opacity:.7}
.approval-card.rejected{border-left-color:#c62828;opacity:.7}
.approval-card h4{font-size:14px;font-weight:600;margin-bottom:6px}
.approval-card .approval-meta{font-size:12px;color:#888;display:flex;gap:16px;margin-bottom:8px}
.approval-card .approval-desc{font-size:13px;color:#555;margin-bottom:10px;line-height:1.5}
.approval-card .approval-actions{display:flex;gap:8px;justify-content:flex-end}

/* --- Doctor 360 View --- */
.doctor-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px;margin-bottom:20px}
.doctor-select-card{background:#fff;border:1px solid #e0e5ee;border-radius:8px;padding:20px;cursor:pointer;transition:all .15s;text-align:center}
.doctor-select-card:hover{box-shadow:0 6px 16px rgba(0,0,0,.1);transform:translateY(-2px);border-color:#0176d3}
.doctor-select-card .doc-avatar{width:64px;height:64px;border-radius:50%;background:#e3f2fd;color:#0176d3;display:flex;align-items:center;justify-content:center;font-size:24px;font-weight:700;margin:0 auto 12px}
.doctor-select-card h4{font-size:15px;font-weight:600;margin-bottom:4px}
.doctor-select-card .doc-inst{font-size:12px;color:#888;margin-bottom:8px}
.doctor-select-card .doc-specialty{font-size:11px;color:#0176d3;background:#e3f2fd;padding:3px 10px;border-radius:12px;display:inline-block}

.doctor-profile-card{background:#fff;border:1px solid #e0e5ee;border-radius:8px;overflow:hidden;margin-bottom:20px}
.doctor-profile-header{background:linear-gradient(135deg,#0d1b2a,#1b3a5c);color:#fff;padding:30px;display:flex;gap:24px;align-items:center}
.doctor-profile-header .doc-avatar-lg{width:80px;height:80px;border-radius:50%;background:rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center;font-size:32px;font-weight:700;flex-shrink:0}
.doctor-profile-header .doc-info h2{font-size:22px;font-weight:700;margin-bottom:4px}
.doctor-profile-header .doc-info p{font-size:13px;opacity:.8}
.doctor-profile-body{padding:24px}
.doctor-stats{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:20px}
.doctor-stat{text-align:center;padding:12px}
.doctor-stat .stat-val{font-size:28px;font-weight:700;color:#0176d3}
.doctor-stat .stat-label{font-size:11px;color:#888;margin-top:4px}

/* --- Timeline (enhanced for Doctor 360) --- */
.timeline-container{position:relative;padding-left:24px}
.timeline-item{position:relative;padding:0 0 20px 24px;border-left:2px solid #e0e5ee}
.timeline-item:last-child{border-left-color:transparent}
.timeline-dot{position:absolute;left:-7px;top:4px;width:12px;height:12px;border-radius:50%;border:2px solid #fff;box-shadow:0 0 0 2px #0176d3}
.timeline-dot.visit{background:#2e7d32}
.timeline-dot.seminar{background:#7b1fa2}
.timeline-dot.specimen{background:#e65100}
.timeline-dot.research{background:#0176d3}
.timeline-dot.ma{background:#00897b}
.timeline-content{background:#fff;border:1px solid #e0e5ee;border-radius:6px;padding:12px 16px}
.timeline-content h5{font-size:13px;font-weight:600;margin-bottom:4px}
.timeline-content p{font-size:12px;color:#666;line-height:1.4}
.timeline-content .tl-date{font-size:10px;color:#aaa;margin-top:4px}

/* --- KOL Map --- */
.kol-tier-section{margin-bottom:24px}
.kol-tier-section h4{font-size:14px;font-weight:600;margin-bottom:12px;padding-bottom:8px;border-bottom:2px solid #e0e5ee}
.kol-chip{display:inline-flex;align-items:center;gap:8px;background:#fff;border:1px solid #e0e5ee;border-radius:20px;padding:6px 16px 6px 8px;margin:4px;font-size:12px;cursor:pointer;transition:all .15s}
.kol-chip:hover{box-shadow:0 2px 8px rgba(0,0,0,.08);border-color:#0176d3}
.kol-chip .kol-score{width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:700;color:#fff}
.kol-chip .kol-score.tier1{background:#c62828}
.kol-chip .kol-score.tier2{background:#e65100}
.kol-chip .kol-score.tier3{background:#0176d3}
.cancer-kol-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:16px}

/* --- Competitive Intelligence --- */
.intel-card{background:#fff;border:1px solid #e0e5ee;border-radius:8px;padding:18px;margin-bottom:12px;border-left:4px solid #7b1fa2}
.intel-card.high{border-left-color:#c62828}
.intel-card.medium{border-left-color:#e65100}
.intel-card.low{border-left-color:#999}
.intel-card h4{font-size:14px;font-weight:600;margin-bottom:6px}
.intel-card .intel-meta{font-size:11px;color:#888;display:flex;gap:12px;margin-bottom:8px}
.intel-card .intel-summary{font-size:13px;color:#555;line-height:1.5;margin-bottom:8px}
.intel-card .intel-action{font-size:12px;color:#0176d3;font-weight:500}
.competitor-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px;margin-bottom:20px}
.competitor-card{background:#fff;border:1px solid #e0e5ee;border-radius:8px;padding:16px;text-align:center}
.competitor-card h5{font-size:13px;font-weight:600;margin-bottom:4px}
.competitor-card .comp-count{font-size:24px;font-weight:700;color:#7b1fa2}

/* --- Compliance Dashboard --- */
.compliance-check{background:#fff;border:1px solid #e0e5ee;border-radius:8px;padding:16px;margin-bottom:12px;display:flex;align-items:center;gap:16px}
.compliance-check .check-icon{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0}
.compliance-check .check-icon.pass{background:#e8f5e9;color:#2e7d32}
.compliance-check .check-icon.warn{background:#fff3e0;color:#e65100}
.compliance-check .check-icon.fail{background:#ffebee;color:#c62828}
.compliance-check .check-detail h5{font-size:14px;font-weight:600;margin-bottom:2px}
.compliance-check .check-detail p{font-size:12px;color:#888}

/* --- Expense Report --- */
.expense-breakdown{margin-top:16px}
.expense-type-row{display:flex;align-items:center;gap:12px;padding:10px 0;border-bottom:1px solid #eee}
.expense-type-row:last-child{border-bottom:none}
.expense-type-row .type-label{width:140px;font-size:13px;font-weight:500}
.expense-type-row .type-bar{flex:1;height:24px;background:#e0e5ee;border-radius:4px;overflow:hidden}
.expense-type-row .type-bar .bar-fill{height:100%;border-radius:4px;background:#0176d3;transition:width .3s}
.expense-type-row .type-amount{width:100px;text-align:right;font-size:13px;font-weight:600;color:#333}

/* --- Territory Analysis --- */
.mr-territory-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:16px;margin-bottom:20px}
.mr-territory-card{background:#fff;border:1px solid #e0e5ee;border-radius:8px;padding:20px;transition:all .15s}
.mr-territory-card:hover{box-shadow:0 4px 12px rgba(0,0,0,.06)}
.mr-territory-card h4{font-size:15px;font-weight:600;margin-bottom:4px}
.mr-territory-card .territory-meta{font-size:12px;color:#888;margin-bottom:12px}
.mr-territory-card .territory-stats{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:12px}
.mr-territory-card .territory-stat{text-align:center;padding:8px;background:#f7f9fc;border-radius:6px}
.mr-territory-card .territory-stat .ts-val{font-size:18px;font-weight:700;color:#0176d3}
.mr-territory-card .territory-stat .ts-label{font-size:10px;color:#888;margin-top:2px}
.mr-doctor-chip{display:inline-block;background:#e3f2fd;color:#1565c0;padding:3px 10px;border-radius:12px;font-size:11px;margin:2px}

/* --- Specimen Tracker --- */
.specimen-card{background:#fff;border:1px solid #e0e5ee;border-radius:8px;padding:18px;margin-bottom:12px;transition:all .15s}
.specimen-card:hover{box-shadow:0 4px 12px rgba(0,0,0,.06)}
.specimen-card .spec-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px}
.specimen-card .spec-header h4{font-size:14px;font-weight:600}
.specimen-card .spec-details{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:8px;margin-bottom:12px;font-size:12px}
.specimen-card .spec-detail-item{padding:6px 10px;background:#f7f9fc;border-radius:4px}
.specimen-card .spec-detail-item .label{color:#888;font-size:10px;display:block}
.specimen-card .spec-detail-item .value{font-weight:500;color:#333}
.specimen-pipeline{display:flex;align-items:center;gap:2px;margin-top:8px}
.specimen-pipeline .pipeline-stage{flex:1;height:8px;background:#e0e5ee;border-radius:4px;transition:background .3s}
.specimen-pipeline .pipeline-stage.active{background:#0176d3}
.specimen-pipeline .pipeline-stage.completed{background:#2e7d32}
.specimen-pipeline .pipeline-stage-labels{display:flex;justify-content:space-between;margin-top:4px;font-size:9px;color:#aaa}

/* --- Review Queue --- */
.review-card{background:#fff;border:1px solid #e0e5ee;border-radius:8px;padding:18px;margin-bottom:12px;border-left:4px solid #e65100}
.review-card.completed{border-left-color:#2e7d32}
.review-card h4{font-size:14px;font-weight:600;margin-bottom:6px}
.review-card .review-meta{font-size:12px;color:#888;margin-bottom:8px}

/* --- Schedule View --- */
.schedule-user-tabs{display:flex;gap:4px;flex-wrap:wrap;margin-bottom:16px;padding:4px;background:#fff;border:1px solid #e0e5ee;border-radius:8px}
.schedule-user-tab{display:flex;align-items:center;gap:6px;padding:8px 14px;border-radius:6px;cursor:pointer;font-size:12px;transition:all .15s;border:1px solid transparent}
.schedule-user-tab:hover{background:#f5f8ff;border-color:#0176d3}
.schedule-user-tab.active{background:#e3f2fd;border-color:#0176d3;font-weight:600;color:#0176d3}
.schedule-user-tab .tab-photo{font-size:18px}
.schedule-user-tab .tab-name{font-weight:500}
.schedule-user-tab .tab-role{font-size:10px;color:#888}
.schedule-week{display:grid;grid-template-columns:repeat(7,1fr);gap:1px;background:#e0e5ee;border-radius:8px;overflow:hidden;margin-bottom:16px}
.schedule-day{background:#fff;min-height:140px;padding:8px;font-size:12px}
.schedule-day.today{background:#fffde7}
.schedule-day.weekend{background:#fafafa}
.schedule-day-header{display:flex;align-items:center;gap:6px;margin-bottom:8px;padding-bottom:6px;border-bottom:1px solid #eee}
.schedule-date{font-weight:700;font-size:14px}
.schedule-date.today-badge{background:#0176d3;color:#fff;padding:2px 8px;border-radius:10px}
.schedule-dow{font-size:11px;color:#888}
.schedule-count{margin-left:auto;background:#0176d3;color:#fff;font-size:9px;padding:1px 6px;border-radius:8px}
.schedule-item{display:flex;gap:6px;padding:5px 6px;border-radius:4px;margin-bottom:3px;cursor:pointer;transition:background .1s;font-size:11px;border-left:3px solid transparent}
.schedule-item:hover{background:#f5f8ff}
.schedule-item.visit{border-left-color:#2e7d32}
.schedule-item.seminar{border-left-color:#7b1fa2}
.schedule-item.ma{border-left-color:#00897b}
.schedule-item.event{border-left-color:#0176d3}
.schedule-item.task{border-left-color:#e65100}
.schedule-item.report{border-left-color:#999}
.si-icon{flex-shrink:0;font-size:14px;width:20px;text-align:center}
.si-body{flex:1;min-width:0}
.si-title{font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.si-sub{color:#888;font-size:10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.si-note{color:#555;font-size:10px;margin-top:2px}
.schedule-empty{color:#ccc;font-size:11px;text-align:center;padding:20px 0}

/* --- Visit Target --- */
.visit-target-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(400px,1fr));gap:16px}
.visit-target-user-card{background:#fff;border:1px solid #e0e5ee;border-radius:8px;padding:20px}
.vt-user-header{display:flex;align-items:center;gap:12px;margin-bottom:12px}
.vt-photo{font-size:32px}
.vt-user-info{flex:1}
.vt-user-info strong{display:block;font-size:15px}
.vt-user-info span{font-size:12px;color:#888}
.vt-rate{text-align:right}
.vt-rate-num{font-size:28px;font-weight:700;display:block}
.vt-progress{height:6px;background:#e0e5ee;border-radius:3px;overflow:hidden;margin-bottom:12px}
.vt-progress-bar{height:100%;border-radius:3px;transition:width .3s}
.vt-stats{display:flex;gap:16px;font-size:12px;color:#888;margin-bottom:12px}
.vt-item{border:1px solid #eee;border-radius:6px;padding:10px 12px;margin-bottom:8px;cursor:pointer;transition:all .15s}
.vt-item:hover{background:#f5f8ff;border-color:#0176d3}
.vt-item-header{display:flex;align-items:center;gap:8px;flex-wrap:wrap;margin-bottom:4px}
.vt-priority{width:22px;height:22px;border-radius:50%;color:#fff;display:inline-flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;flex-shrink:0}
.vt-item-title{font-weight:600;font-size:13px}
.vt-item-inst{font-size:11px;color:#888}
.vt-item-body{display:flex;align-items:center;gap:8px;font-size:11px;color:#666}
.vt-mini-bar{flex:1;height:6px;background:#e0e5ee;border-radius:3px;overflow:hidden;min-width:60px}
.vt-mini-fill{height:100%;background:#0176d3;border-radius:3px}
.vt-next{font-size:10px;color:#0176d3;margin-top:4px}
.vt-note{font-size:10px;color:#888;margin-top:4px;line-height:1.4}

/* --- Workflow Engine --- */
.wf-type-grid{display:flex;flex-direction:column;gap:8px}
.wf-type-card{display:flex;align-items:center;gap:16px;padding:12px 16px;background:#fafbfc;border-radius:8px;cursor:pointer;transition:background .15s}
.wf-type-card:hover{background:#eef2f7}
.wf-type-icon{font-size:28px}
.wf-type-info{flex:1}
.wf-type-name{font-weight:600;font-size:14px}
.wf-type-stats{font-size:12px;color:#666;margin-top:2px}
.wf-card{padding:14px;border:1px solid #e0e5ec;border-radius:8px;margin-bottom:10px;cursor:pointer;transition:box-shadow .15s,border-color .15s}
.wf-card:hover{box-shadow:0 2px 8px rgba(0,0,0,.08);border-color:#b0bec5}
.wf-card.wf-action{background:#fff8e1;border-color:#ffe082}
.wf-card.wf-overdue{border-color:#ef9a9a;background:#fff5f5}
.wf-card-header{display:flex;align-items:center;gap:12px}
.wf-icon{font-size:24px}
.wf-card-title{flex:1;min-width:0}
.wf-card-title strong{font-size:14px;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.wf-card-meta{display:flex;gap:6px;align-items:center;margin-top:4px;font-size:12px;color:#666;flex-wrap:wrap}
.wf-card-progress{text-align:right;min-width:100px}
.wf-progress-text{font-size:18px;font-weight:700;color:#333}
.wf-progress-bar{height:6px;background:#e0e5ec;border-radius:3px;overflow:hidden;margin:4px 0}
.wf-progress-fill{height:100%;border-radius:3px;transition:width .3s}
.wf-progress-steps{font-size:11px;color:#999}
.wf-steps-mini{display:flex;align-items:center;gap:0;margin:8px 0;flex-wrap:wrap}
.wf-step-dot{width:16px;height:16px;border-radius:50%;border:2px solid #ccc;background:#fff;flex-shrink:0}
.wf-step-dot.wf-step-done{background:#4caf50;border-color:#4caf50}
.wf-step-dot.wf-step-active{background:#1565c0;border-color:#1565c0;animation:pulse 2s infinite}
.wf-step-dot.wf-step-pending{background:#fff;border-color:#ccc}
.wf-step-line{width:20px;height:2px;background:#ccc;flex-shrink:0}
.wf-step-line.wf-line-done{background:#4caf50}
.wf-current-step{display:flex;gap:8px;align-items:center;flex-wrap:wrap;font-size:12px;margin-top:8px;padding:6px 8px;background:#f5f7fa;border-radius:4px}
.wf-card-footer{display:flex;gap:16px;font-size:11px;color:#999;margin-top:8px;padding-top:8px;border-top:1px solid #f0f0f0;flex-wrap:wrap}
.wf-detail-header{display:flex;gap:24px;background:white;padding:20px;border-radius:8px;margin-bottom:16px;box-shadow:0 1px 3px rgba(0,0,0,.06);align-items:flex-start}
.wf-detail-info{flex:1}
.wf-detail-info h2{font-size:18px;margin:0}
.wf-detail-progress{text-align:center;flex-shrink:0}
.wf-progress-circle{width:80px;height:80px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:700;background:conic-gradient(var(--color,#1565c0) calc(var(--pct,0)*3.6deg),#e8edf2 0);position:relative}
.wf-progress-circle span{background:white;width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center}
.wf-actions-bar{display:flex;gap:8px;align-items:center;padding:12px 16px;background:white;border-radius:8px;margin-bottom:16px;box-shadow:0 1px 3px rgba(0,0,0,.06);flex-wrap:wrap}
.wf-timeline{padding:16px 0 16px 16px}
.wf-tl-step{display:flex;gap:16px;position:relative;padding-bottom:24px}
.wf-tl-step:last-child{padding-bottom:0}
.wf-tl-step::before{content:'';position:absolute;left:15px;top:32px;bottom:0;width:2px;background:#e0e5ec}
.wf-tl-step:last-child::before{display:none}
.wf-tl-step.wf-tl-done::before{background:#4caf50}
.wf-tl-step.wf-tl-active::before{background:linear-gradient(180deg,#1565c0 0%,#e0e5ec 100%)}
.wf-tl-marker{width:32px;height:32px;border-radius:50%;background:#e0e5ec;display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:700;color:white;flex-shrink:0;z-index:1}
.wf-tl-content{flex:1;padding-top:4px}
.wf-tl-header{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.wf-tl-meta{display:flex;gap:16px;font-size:12px;color:#888;margin-top:4px;flex-wrap:wrap}
.wf-tl-comment{font-size:12px;color:#555;margin-top:6px;padding:8px 12px;background:#f7f9fc;border-radius:6px;border-left:3px solid #90caf9;white-space:pre-wrap;line-height:1.5}
.wf-form .wf-form-row{margin-bottom:14px}
.wf-form label{display:block;font-size:12px;font-weight:600;color:#555;margin-bottom:4px}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.6}}

/* --- Calendar event colors --- */
.cal-event.planned{background:#e3f2fd;color:#0176d3;border-left:3px solid #0176d3;font-size:11px}
.cal-event.visit{background:#e8f5e9;color:#2e7d32;border-left:3px solid #2e7d32;font-size:11px}
.cal-event.overdue{background:#ffebee;color:#c62828;border-left:3px solid #c62828;font-size:11px;font-weight:600}
.cal-day{cursor:pointer;min-height:80px;transition:background .15s}
.cal-day:hover{background:#f5f7fa}
.cal-today{background:#e3f2fd !important;border:2px solid #0176d3}
.cal-today .day-num{color:#0176d3;font-weight:700}

/* --- KPI cols-5 --- */
.kpi-row.cols-5{grid-template-columns:repeat(5,1fr)}

/* --- Notification bell & panel --- */
.notif-badge{position:absolute;top:-8px;right:-8px;background:#c62828;color:#fff;border-radius:50%;width:18px;height:18px;font-size:11px;display:flex;align-items:center;justify-content:center;font-weight:700}
.notif-panel{position:absolute;top:48px;right:16px;width:380px;max-height:500px;overflow-y:auto;background:#fff;border-radius:10px;box-shadow:0 8px 32px rgba(0,0,0,.18);z-index:1000;border:1px solid #e0e5ec}
.notif-header{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;border-bottom:1px solid #eee}
.notif-item{padding:12px 16px;border-bottom:1px solid #f5f5f5;cursor:pointer;transition:background .15s}
.notif-item:hover{background:#f5f7fa}
.notif-unread{background:#e3f2fd}
.notif-read{opacity:0.65}
.notif-empty{padding:32px;text-align:center;color:#999;font-size:14px}

/* --- Responsive --- */
@media(max-width:1200px){.kpi-row.cols-6{grid-template-columns:repeat(3,1fr)}.chart-grid{grid-template-columns:1fr}.detail-grid{grid-template-columns:1fr}.doctor-stats{grid-template-columns:repeat(2,1fr)}.mr-territory-grid{grid-template-columns:1fr}.cancer-kol-grid{grid-template-columns:1fr}.visit-target-grid{grid-template-columns:1fr}}
@media(max-width:768px){.sidebar{width:200px}.form-grid{grid-template-columns:1fr}.kpi-row.cols-4{grid-template-columns:repeat(2,1fr)}.kanban{grid-template-columns:1fr}.doctor-grid{grid-template-columns:1fr}.competitor-grid{grid-template-columns:repeat(2,1fr)}.doctor-profile-header{flex-direction:column;text-align:center}.doctor-stats{grid-template-columns:1fr}.schedule-week{grid-template-columns:1fr}}
